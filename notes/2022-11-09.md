---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.14.1
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

# Model Optimization

```{code-cell} ipython3
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
import pandas as pd
from sklearn import datasets
from sklearn import cluster
from sklearn import svm, datasets
from sklearn.model_selection import GridSearchCV
from sklearn.model_selection import train_test_split
from sklearn import tree
```

```{code-cell} ipython3
iris_df = sns.load_dataset('iris')


iris_X = iris_df.drop(columns=['species'])

iris_y = iris_df['species']
```

```{code-cell} ipython3
iris_X_train, iris_X_test, iris_y_train, iris_y_test = train_test_split(iris_X,iris_y)
```

```{code-cell} ipython3
dt = tree.DecisionTreeClassifier()
params_dt = {'criterion':['gini','entropy'],'max_depth':[2,3,4],
       'min_samples_leaf':list(range(2,20,2))}
```

```{code-cell} ipython3
dt_opt = GridSearchCV(dt,params_dt,cv=10)
```

```{code-cell} ipython3
dt_opt.fit(iris_X_train,iris_y_train)
```

```{code-cell} ipython3
y_pred = dt_opt.predict(iris_X_test)
```

```{code-cell} ipython3
dt_opt.score(iris_X_test,iris_y_test)
```

```{code-cell} ipython3
dt_opt.best_params_
```

```{code-cell} ipython3
pd.DataFrame(dt_opt.cv_results_)
```

```{code-cell} ipython3
from sklearn import model_selection
```

```{code-cell} ipython3
model_selection.RandomizedSearchCV()
```
