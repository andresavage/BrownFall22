---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Building Datasets from Multiple Sources

focus this week is on how to programmatically combine sources of data

We will start by looking at combining multiple tabular data formats and see how to get data from other sources.  



## Self- assessment, what's your plan

Take a few minutes to think about the following questions and make a few notes
for yourself whereever you need them to be (a planner, calendar, etc).
Share one takeaway or question you have below when you're done.

1. What achievements have you earned?
1. Does BrightSpace seem accurate to what you've done?
1. If not, e-mail brownsarahm with [CSC310] or [DSP310] in the subject and specific details about what you think is missing and why
1. Are you on track to earn the grade you want in this class?
1. If not, what will you need to do (respond more in class, submit more
   assignments, use your portfolio to catch up) to get back on track?
1. If you are on track and you want to earn above a B, take a minute to think
about your portfolio. (tip: post an idea as an issue to get early feedback and help shaping your idea)

## Logistics

Check your earned achievements.


## Merges

```{code-cell} ipython3
import pandas as pd
```

```{code-cell} ipython3
course_data_url = 'https://raw.githubusercontent.com/rhodyprog4ds/rhodyds/main/data/'
```

 We can load in both data sets

```{code-cell} ipython3
df_18 = pd.read_csv(course_data_url+ '2018-players.csv')
df_19 = pd.read_csv(course_data_url+ '2019-players.csv')
```

and take a peek at each

```{code-cell} ipython3
df_18.head(2)
```

```{code-cell} ipython3
df_19.columns
```

Let's make note of the shape of each

```{code-cell} ipython3
df_18.shape, df_19.shape
```

We can combine them vertically:

```{code-cell} ipython3
pd.concat([df_18,df_19]).shape
```

Note that this has the maximum number of columns (because both had some overlapping
  columns) and the total number of rows.


## How can we find which players changed teams?

To do this we want to have one player column and a column with each team.

We can use a merge to do that, we tell it what column to use to combine the data.

```{code-cell} ipython3
pd.merge(df_18,df_19, on = 'PLAYER_ID',
        suffixes=('_2018','_2019')).head(2)
```

We also told it what to append to any column names that match, but are not the same across both datasets.

```{code-cell} ipython3
df_18.head(1)
```

```{code-cell} ipython3
df_19.head(1)
```

```{code-cell} ipython3
df1819 = pd.merge(df_18,df_19, on = 'PLAYER_ID',
        suffixes=('_2018','_2019'))
```

```{code-cell} ipython3
df1819.shape
```

By default, this uses an *inner* merge, so we get the rows that are in both datasets only.

```{code-cell} ipython3
df1819.head()
```

Some players appear twice, because they were in one of the datsets twice, this
happens when a player plays for two teasm in one season. 


Which players played in 2018, but not 2019

```{code-cell} ipython3
pd.merge(df_18,df_19,on='PLAYER_ID', how='left')
```

```{code-cell} ipython3
df_l = pd.merge(df_18,df_19,on='PLAYER_ID', how='left', suffixes=('_2018','_2019'))
df_l[df_l['SEASON_2019'].isna()]
```

```{code-cell} ipython3
pd.merge(df_18.drop(columns='SEASON'),df_19.drop(columns='SEASON'), on = ['PLAYER_ID','TEAM_ID'])
```

```{code-cell} ipython3

```
