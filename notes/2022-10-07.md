---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.14.1
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Databases

```{code-cell} ipython3
import pandas as pd
from urllib import request
import sqlite3
```

```{code-cell} ipython3
request.urlretrieve('https://github.com/rhodyprog4ds/rhodyds/raw/main/data/nba1819.db',
   'nba1819.db')
```

```{code-cell} ipython3
conn = sqlite3.connect('nba1819.db')
cursor = conn.cursor()
```

```{code-cell} ipython3
cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
```

```{code-cell} ipython3
cursor.fetchall()
```

```{code-cell} ipython3
pd.read_sql("SELECT * FROM teams",conn)
```

```{code-cell} ipython3
pd.read_sql(con=conn,sql="SELECT * FROM teams LIMIT 3")
```

```{code-cell} ipython3
pd.read_sql("SELECT * FROM playerTeams2018 LIMIT 1",conn)
```

```{code-cell} ipython3
p18 =pd.read_sql("SELECT PLAYER_ID FROM playerTeams2018 ",conn)
```

```{code-cell} ipython3
p18.value_counts().sort_values(ascending=False).head(10)
```

```{code-cell} ipython3
pd.read_sql("SELECT PLAYER_NAME FROM playerNames WHERE PLAYER_ID = 1629150",conn)
```

DId more player change conference or stay within when traded from 18 to 19

```{code-cell} ipython3
# get conferences

# get 2018 players 

# add conferences to 2018 players wiht a left merge on teams


# get 2019 players

# add conference

# inner merge the two tables and add suffixes to conference

# subset the dataframe with only rows where 18 & 19 conference are diff
```
